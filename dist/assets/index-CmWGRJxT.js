var ct=Object.defineProperty;var ot=(t,u,d)=>u in t?ct(t,u,{enumerable:!0,configurable:!0,writable:!0,value:d}):t[u]=d;var A=(t,u,d)=>(ot(t,typeof u!="symbol"?u+"":u,d),d);(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const e of n)if(e.type==="childList")for(const f of e.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&i(f)}).observe(document,{childList:!0,subtree:!0});function d(n){const e={};return n.integrity&&(e.integrity=n.integrity),n.referrerPolicy&&(e.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?e.credentials="include":n.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function i(n){if(n.ep)return;n.ep=!0;const e=d(n);fetch(n.href,e)}})();var se=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function at(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ve={exports:{}};(function(t){var u=Object.prototype.hasOwnProperty,d="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(d=!1));function n(b,w,h){this.fn=b,this.context=w,this.once=h||!1}function e(b,w,h,C,T){if(typeof h!="function")throw new TypeError("The listener must be a function");var p=new n(h,C||b,T),l=d?d+w:w;return b._events[l]?b._events[l].fn?b._events[l]=[b._events[l],p]:b._events[l].push(p):(b._events[l]=p,b._eventsCount++),b}function f(b,w){--b._eventsCount===0?b._events=new i:delete b._events[w]}function y(){this._events=new i,this._eventsCount=0}y.prototype.eventNames=function(){var w=[],h,C;if(this._eventsCount===0)return w;for(C in h=this._events)u.call(h,C)&&w.push(d?C.slice(1):C);return Object.getOwnPropertySymbols?w.concat(Object.getOwnPropertySymbols(h)):w},y.prototype.listeners=function(w){var h=d?d+w:w,C=this._events[h];if(!C)return[];if(C.fn)return[C.fn];for(var T=0,p=C.length,l=new Array(p);T<p;T++)l[T]=C[T].fn;return l},y.prototype.listenerCount=function(w){var h=d?d+w:w,C=this._events[h];return C?C.fn?1:C.length:0},y.prototype.emit=function(w,h,C,T,p,l){var s=d?d+w:w;if(!this._events[s])return!1;var r=this._events[s],o=arguments.length,a,m;if(r.fn){switch(r.once&&this.removeListener(w,r.fn,void 0,!0),o){case 1:return r.fn.call(r.context),!0;case 2:return r.fn.call(r.context,h),!0;case 3:return r.fn.call(r.context,h,C),!0;case 4:return r.fn.call(r.context,h,C,T),!0;case 5:return r.fn.call(r.context,h,C,T,p),!0;case 6:return r.fn.call(r.context,h,C,T,p,l),!0}for(m=1,a=new Array(o-1);m<o;m++)a[m-1]=arguments[m];r.fn.apply(r.context,a)}else{var v=r.length,I;for(m=0;m<v;m++)switch(r[m].once&&this.removeListener(w,r[m].fn,void 0,!0),o){case 1:r[m].fn.call(r[m].context);break;case 2:r[m].fn.call(r[m].context,h);break;case 3:r[m].fn.call(r[m].context,h,C);break;case 4:r[m].fn.call(r[m].context,h,C,T);break;default:if(!a)for(I=1,a=new Array(o-1);I<o;I++)a[I-1]=arguments[I];r[m].fn.apply(r[m].context,a)}}return!0},y.prototype.on=function(w,h,C){return e(this,w,h,C,!1)},y.prototype.once=function(w,h,C){return e(this,w,h,C,!0)},y.prototype.removeListener=function(w,h,C,T){var p=d?d+w:w;if(!this._events[p])return this;if(!h)return f(this,p),this;var l=this._events[p];if(l.fn)l.fn===h&&(!T||l.once)&&(!C||l.context===C)&&f(this,p);else{for(var s=0,r=[],o=l.length;s<o;s++)(l[s].fn!==h||T&&!l[s].once||C&&l[s].context!==C)&&r.push(l[s]);r.length?this._events[p]=r.length===1?r[0]:r:f(this,p)}return this},y.prototype.removeAllListeners=function(w){var h;return w?(h=d?d+w:w,this._events[h]&&f(this,h)):(this._events=new i,this._eventsCount=0),this},y.prototype.off=y.prototype.removeListener,y.prototype.addListener=y.prototype.on,y.prefixed=d,y.EventEmitter=y,t.exports=y})(Ve);var ft=Ve.exports;const Ze=at(ft);/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var je=function(t,u){return je=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,i){d.__proto__=i}||function(d,i){for(var n in i)i.hasOwnProperty(n)&&(d[n]=i[n])},je(t,u)};function et(t,u){je(t,u);function d(){this.constructor=t}t.prototype=u===null?Object.create(u):(d.prototype=u.prototype,new d)}function lt(t){var u=typeof Symbol=="function"&&t[Symbol.iterator],d=0;return u?u.call(t):{next:function(){return t&&d>=t.length&&(t=void 0),{value:t&&t[d++],done:!t}}}}function ht(t,u){var d=typeof Symbol=="function"&&t[Symbol.iterator];if(!d)return t;var i=d.call(t),n,e=[],f;try{for(;(u===void 0||u-- >0)&&!(n=i.next()).done;)e.push(n.value)}catch(y){f={error:y}}finally{try{n&&!n.done&&(d=i.return)&&d.call(i)}finally{if(f)throw f.error}}return e}function mt(){for(var t=[],u=0;u<arguments.length;u++)t=t.concat(ht(arguments[u]));return t}var tt=function(){function t(u,d){this.target=d,this.type=u}return t}(),pt=function(t){et(u,t);function u(d,i){var n=t.call(this,"error",i)||this;return n.message=d.message,n.error=d,n}return u}(tt),gt=function(t){et(u,t);function u(d,i,n){d===void 0&&(d=1e3),i===void 0&&(i="");var e=t.call(this,"close",n)||this;return e.wasClean=!0,e.code=d,e.reason=i,e}return u}(tt);/*!
 * Reconnecting WebSocket
 * by Pedro Ladaria <pedro.ladaria@gmail.com>
 * https://github.com/pladaria/reconnecting-websocket
 * License MIT
 */var bt=function(){if(typeof WebSocket<"u")return WebSocket},yt=function(t){return typeof t<"u"&&!!t&&t.CLOSING===2},ce={maxReconnectionDelay:1e4,minReconnectionDelay:1e3+Math.random()*4e3,minUptime:5e3,reconnectionDelayGrowFactor:1.3,connectionTimeout:4e3,maxRetries:1/0,maxEnqueuedMessages:1/0,startClosed:!1,debug:!1},vt=function(){function t(u,d,i){var n=this;i===void 0&&(i={}),this._listeners={error:[],message:[],open:[],close:[]},this._retryCount=-1,this._shouldReconnect=!0,this._connectLock=!1,this._binaryType="blob",this._closeCalled=!1,this._messageQueue=[],this.onclose=null,this.onerror=null,this.onmessage=null,this.onopen=null,this._handleOpen=function(e){n._debug("open event");var f=n._options.minUptime,y=f===void 0?ce.minUptime:f;clearTimeout(n._connectTimeout),n._uptimeTimeout=setTimeout(function(){return n._acceptOpen()},y),n._ws.binaryType=n._binaryType,n._messageQueue.forEach(function(b){return n._ws.send(b)}),n._messageQueue=[],n.onopen&&n.onopen(e),n._listeners.open.forEach(function(b){return n._callEventListener(e,b)})},this._handleMessage=function(e){n._debug("message event"),n.onmessage&&n.onmessage(e),n._listeners.message.forEach(function(f){return n._callEventListener(e,f)})},this._handleError=function(e){n._debug("error event",e.message),n._disconnect(void 0,e.message==="TIMEOUT"?"timeout":void 0),n.onerror&&n.onerror(e),n._debug("exec error listeners"),n._listeners.error.forEach(function(f){return n._callEventListener(e,f)}),n._connect()},this._handleClose=function(e){n._debug("close event"),n._clearTimeouts(),n._shouldReconnect&&n._connect(),n.onclose&&n.onclose(e),n._listeners.close.forEach(function(f){return n._callEventListener(e,f)})},this._url=u,this._protocols=d,this._options=i,this._options.startClosed&&(this._shouldReconnect=!1),this._connect()}return Object.defineProperty(t,"CONNECTING",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t,"OPEN",{get:function(){return 1},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CLOSING",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(t,"CLOSED",{get:function(){return 3},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CONNECTING",{get:function(){return t.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"OPEN",{get:function(){return t.OPEN},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSING",{get:function(){return t.CLOSING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"CLOSED",{get:function(){return t.CLOSED},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"binaryType",{get:function(){return this._ws?this._ws.binaryType:this._binaryType},set:function(u){this._binaryType=u,this._ws&&(this._ws.binaryType=u)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"retryCount",{get:function(){return Math.max(this._retryCount,0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bufferedAmount",{get:function(){var u=this._messageQueue.reduce(function(d,i){return typeof i=="string"?d+=i.length:i instanceof Blob?d+=i.size:d+=i.byteLength,d},0);return u+(this._ws?this._ws.bufferedAmount:0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extensions",{get:function(){return this._ws?this._ws.extensions:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return this._ws?this._ws.protocol:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"readyState",{get:function(){return this._ws?this._ws.readyState:this._options.startClosed?t.CLOSED:t.CONNECTING},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"url",{get:function(){return this._ws?this._ws.url:""},enumerable:!0,configurable:!0}),t.prototype.close=function(u,d){if(u===void 0&&(u=1e3),this._closeCalled=!0,this._shouldReconnect=!1,this._clearTimeouts(),!this._ws){this._debug("close enqueued: no ws instance");return}if(this._ws.readyState===this.CLOSED){this._debug("close: already closed");return}this._ws.close(u,d)},t.prototype.reconnect=function(u,d){this._shouldReconnect=!0,this._closeCalled=!1,this._retryCount=-1,!this._ws||this._ws.readyState===this.CLOSED?this._connect():(this._disconnect(u,d),this._connect())},t.prototype.send=function(u){if(this._ws&&this._ws.readyState===this.OPEN)this._debug("send",u),this._ws.send(u);else{var d=this._options.maxEnqueuedMessages,i=d===void 0?ce.maxEnqueuedMessages:d;this._messageQueue.length<i&&(this._debug("enqueue",u),this._messageQueue.push(u))}},t.prototype.addEventListener=function(u,d){this._listeners[u]&&this._listeners[u].push(d)},t.prototype.dispatchEvent=function(u){var d,i,n=this._listeners[u.type];if(n)try{for(var e=lt(n),f=e.next();!f.done;f=e.next()){var y=f.value;this._callEventListener(u,y)}}catch(b){d={error:b}}finally{try{f&&!f.done&&(i=e.return)&&i.call(e)}finally{if(d)throw d.error}}return!0},t.prototype.removeEventListener=function(u,d){this._listeners[u]&&(this._listeners[u]=this._listeners[u].filter(function(i){return i!==d}))},t.prototype._debug=function(){for(var u=[],d=0;d<arguments.length;d++)u[d]=arguments[d];this._options.debug&&console.log.apply(console,mt(["RWS>"],u))},t.prototype._getNextDelay=function(){var u=this._options,d=u.reconnectionDelayGrowFactor,i=d===void 0?ce.reconnectionDelayGrowFactor:d,n=u.minReconnectionDelay,e=n===void 0?ce.minReconnectionDelay:n,f=u.maxReconnectionDelay,y=f===void 0?ce.maxReconnectionDelay:f,b=0;return this._retryCount>0&&(b=e*Math.pow(i,this._retryCount-1),b>y&&(b=y)),this._debug("next delay",b),b},t.prototype._wait=function(){var u=this;return new Promise(function(d){setTimeout(d,u._getNextDelay())})},t.prototype._getNextUrl=function(u){if(typeof u=="string")return Promise.resolve(u);if(typeof u=="function"){var d=u();if(typeof d=="string")return Promise.resolve(d);if(d.then)return d}throw Error("Invalid URL")},t.prototype._connect=function(){var u=this;if(!(this._connectLock||!this._shouldReconnect)){this._connectLock=!0;var d=this._options,i=d.maxRetries,n=i===void 0?ce.maxRetries:i,e=d.connectionTimeout,f=e===void 0?ce.connectionTimeout:e,y=d.WebSocket,b=y===void 0?bt():y;if(this._retryCount>=n){this._debug("max retries reached",this._retryCount,">=",n);return}if(this._retryCount++,this._debug("connect",this._retryCount),this._removeListeners(),!yt(b))throw Error("No valid WebSocket class provided");this._wait().then(function(){return u._getNextUrl(u._url)}).then(function(w){u._closeCalled||(u._debug("connect",{url:w,protocols:u._protocols}),u._ws=u._protocols?new b(w,u._protocols):new b(w),u._ws.binaryType=u._binaryType,u._connectLock=!1,u._addListeners(),u._connectTimeout=setTimeout(function(){return u._handleTimeout()},f))})}},t.prototype._handleTimeout=function(){this._debug("timeout event"),this._handleError(new pt(Error("TIMEOUT"),this))},t.prototype._disconnect=function(u,d){if(u===void 0&&(u=1e3),this._clearTimeouts(),!!this._ws){this._removeListeners();try{this._ws.close(u,d),this._handleClose(new gt(u,d,this))}catch{}}},t.prototype._acceptOpen=function(){this._debug("accept open"),this._retryCount=0},t.prototype._callEventListener=function(u,d){"handleEvent"in d?d.handleEvent(u):d(u)},t.prototype._removeListeners=function(){this._ws&&(this._debug("removeListeners"),this._ws.removeEventListener("open",this._handleOpen),this._ws.removeEventListener("close",this._handleClose),this._ws.removeEventListener("message",this._handleMessage),this._ws.removeEventListener("error",this._handleError))},t.prototype._addListeners=function(){this._ws&&(this._debug("addListeners"),this._ws.addEventListener("open",this._handleOpen),this._ws.addEventListener("close",this._handleClose),this._ws.addEventListener("message",this._handleMessage),this._ws.addEventListener("error",this._handleError))},t.prototype._clearTimeouts=function(){clearTimeout(this._connectTimeout),clearTimeout(this._uptimeTimeout)},t}();const _t=vt;function Et(t){const u=Object.entries(t).filter(([,d])=>Array.isArray(d)?d.length:d!==void 0).reduce((d,[i,n])=>(d[i]=n,d),{});return Object.entries(u).map(d=>`${d[0]}=${encodeURIComponent(d[1])}`).join("&")}class Tt extends Ze{constructor(d,i,n){super();A(this,"stream");A(this,"state","initializing");A(this,"sharedConnectionPools",[]);A(this,"sharedConnections",[]);A(this,"nonSharedConnections",[]);A(this,"idCounter",0);this.genId=this.genId.bind(this),this.useChannel=this.useChannel.bind(this),this.useSharedConnection=this.useSharedConnection.bind(this),this.removeSharedConnection=this.removeSharedConnection.bind(this),this.removeSharedConnectionPool=this.removeSharedConnectionPool.bind(this),this.connectToChannel=this.connectToChannel.bind(this),this.disconnectToChannel=this.disconnectToChannel.bind(this),this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onMessage=this.onMessage.bind(this),this.send=this.send.bind(this),this.close=this.close.bind(this),n=n??{};const e=Et({i:i==null?void 0:i.token,_t:Date.now()}),f=d.replace("http://","ws://").replace("https://","wss://");this.stream=new _t(`${f}/streaming?${e}`,"",{minReconnectionDelay:1,WebSocket:n.WebSocket}),this.stream.addEventListener("open",this.onOpen),this.stream.addEventListener("close",this.onClose),this.stream.addEventListener("message",this.onMessage)}genId(){return(++this.idCounter).toString()}useChannel(d,i,n){return i?this.connectToChannel(d,i):this.useSharedConnection(d,n)}useSharedConnection(d,i){let n=this.sharedConnectionPools.find(f=>f.channel===d);n==null&&(n=new Lt(this,d,this.genId()),this.sharedConnectionPools.push(n));const e=new wt(this,d,n,i);return this.sharedConnections.push(e),e}removeSharedConnection(d){this.sharedConnections=this.sharedConnections.filter(i=>i!==d)}removeSharedConnectionPool(d){this.sharedConnectionPools=this.sharedConnectionPools.filter(i=>i!==d)}connectToChannel(d,i){const n=new Ct(this,d,this.genId(),i);return this.nonSharedConnections.push(n),n}disconnectToChannel(d){this.nonSharedConnections=this.nonSharedConnections.filter(i=>i!==d)}onOpen(){const d=this.state==="reconnecting";if(this.state="connected",this.emit("_connected_"),d){for(const i of this.sharedConnectionPools)i.connect();for(const i of this.nonSharedConnections)i.connect()}}onClose(){this.state==="connected"&&(this.state="reconnecting",this.emit("_disconnected_"))}onMessage(d){const{type:i,body:n}=JSON.parse(d.data);if(i==="channel"){const e=n.id;let f;if(f=this.sharedConnections.filter(y=>y.id===e),f.length===0){const y=this.nonSharedConnections.find(b=>b.id===e);y&&(f=[y])}for(const y of f)y.emit(n.type,n.body),y.inCount++}else this.emit(i,n)}send(d,i){if(typeof d=="string"){this.stream.send(JSON.stringify({type:d,...i===void 0?{}:{body:i}}));return}this.stream.send(JSON.stringify(d))}ping(){this.stream.send("ping")}heartbeat(){this.stream.send("h")}close(){this.stream.close()}}class Lt{constructor(u,d,i){A(this,"channel");A(this,"id");A(this,"stream");A(this,"users",0);A(this,"disposeTimerId");A(this,"isConnected",!1);this.onStreamDisconnected=this.onStreamDisconnected.bind(this),this.inc=this.inc.bind(this),this.dec=this.dec.bind(this),this.connect=this.connect.bind(this),this.disconnect=this.disconnect.bind(this),this.channel=d,this.stream=u,this.id=i,this.stream.on("_disconnected_",this.onStreamDisconnected)}onStreamDisconnected(){this.isConnected=!1}inc(){this.users===0&&!this.isConnected&&this.connect(),this.users++,this.disposeTimerId&&(clearTimeout(this.disposeTimerId),this.disposeTimerId=null)}dec(){this.users--,this.users===0&&(this.disposeTimerId=setTimeout(()=>{this.disconnect()},3e3))}connect(){this.isConnected||(this.isConnected=!0,this.stream.send("connect",{channel:this.channel,id:this.id}))}disconnect(){this.stream.off("_disconnected_",this.onStreamDisconnected),this.stream.send("disconnect",{id:this.id}),this.stream.removeSharedConnectionPool(this)}}class dt extends Ze{constructor(d,i,n){super();A(this,"channel");A(this,"stream");A(this,"name");A(this,"inCount",0);A(this,"outCount",0);this.send=this.send.bind(this),this.stream=d,this.channel=i,this.name=n}send(d,i){this.stream.send("ch",{id:this.id,type:d,body:i}),this.outCount++}}class wt extends dt{constructor(d,i,n,e){super(d,i,e);A(this,"pool");this.dispose=this.dispose.bind(this),this.pool=n,this.pool.inc()}get id(){return this.pool.id}dispose(){this.pool.dec(),this.removeAllListeners(),this.stream.removeSharedConnection(this)}}class Ct extends dt{constructor(d,i,n,e){super(d,i);A(this,"id");A(this,"params");this.connect=this.connect.bind(this),this.dispose=this.dispose.bind(this),this.params=e,this.id=n,this.connect()}connect(){this.stream.send("connect",{channel:this.channel,id:this.id,params:this.params})}dispose(){this.removeAllListeners(),this.stream.send("disconnect",{id:this.id}),this.stream.disconnectToChannel(this)}}const It=Symbol();class Ge{constructor(u){A(this,"origin");A(this,"credential");A(this,"fetch");this.origin=u.origin,this.credential=u.credential,this.fetch=u.fetch??((...d)=>fetch(...d))}request(u,d={},i){return new Promise((n,e)=>{this.fetch(`${this.origin}/api/${u}`,{method:"POST",body:JSON.stringify({...d,i:i!==void 0?i:this.credential}),headers:{"Content-Type":"application/json"},credentials:"omit",cache:"no-cache"}).then(async f=>{const y=f.status===204?null:await f.json();f.status===200||f.status===204?n(y):e({[It]:!0,...y.error})}).catch(e)})}}var Ne={},W={},oe={},ye={},ut={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.createLanguage=t.lazy=t.lineEnd=t.lineBegin=t.char=t.newline=t.crlf=t.lf=t.cr=t.notMatch=t.alt=t.seq=t.regexp=t.str=t.Parser=t.failure=t.success=void 0;function u(T,p){return{success:!0,value:p,index:T}}t.success=u;function d(){return{success:!1}}t.failure=d;class i{constructor(p,l){this.handler=(s,r,o)=>{if(o.trace&&this.name!=null){const a=`${r}`;console.log(`${a.padEnd(6," ")}enter ${this.name}`);const m=p(s,r,o);if(m.success){const v=`${r}:${m.index}`;console.log(`${v.padEnd(6," ")}match ${this.name}`)}else{const v=`${r}`;console.log(`${v.padEnd(6," ")}fail ${this.name}`)}return m}return p(s,r,o)},this.name=l}map(p){return new i((l,s,r)=>{const o=this.handler(l,s,r);return o.success?u(o.index,p(o.value)):o})}text(){return new i((p,l,s)=>{const r=this.handler(p,l,s);if(!r.success)return r;const o=p.slice(l,r.index);return u(r.index,o)})}many(p){return new i((l,s,r)=>{let o,a=s;const m=[];for(;a<l.length&&(o=this.handler(l,a,r),!!o.success);)a=o.index,m.push(o.value);return m.length<p?d():u(a,m)})}sep(p,l){if(l<1)throw new Error('"min" must be a value greater than or equal to 1.');return f([this,f([p,this],1).many(l-1)]).map(s=>[s[0],...s[1]])}option(){return y([this,b(null)])}}t.Parser=i;function n(T){return new i((p,l,s)=>p.length-l<T.length||p.substr(l,T.length)!==T?d():u(l+T.length,T))}t.str=n;function e(T){const p=RegExp(`^(?:${T.source})`,T.flags);return new i((l,s,r)=>{const o=l.slice(s),a=p.exec(o);return a==null?d():u(s+a[0].length,a[0])})}t.regexp=e;function f(T,p){return new i((l,s,r)=>{let o,a=s;const m=[];for(let v=0;v<T.length;v++){if(o=T[v].handler(l,a,r),!o.success)return o;a=o.index,m.push(o.value)}return u(a,p!=null?m[p]:m)})}t.seq=f;function y(T){return new i((p,l,s)=>{let r;for(let o=0;o<T.length;o++)if(r=T[o].handler(p,l,s),r.success)return r;return d()})}t.alt=y;function b(T){return new i((p,l,s)=>u(l,T))}function w(T){return new i((p,l,s)=>T.handler(p,l,s).success?d():u(l,null))}t.notMatch=w,t.cr=n("\r"),t.lf=n(`
`),t.crlf=n(`\r
`),t.newline=y([t.crlf,t.cr,t.lf]),t.char=new i((T,p,l)=>{if(T.length-p<1)return d();const s=T.charAt(p);return u(p+1,s)}),t.lineBegin=new i((T,p,l)=>p===0||t.cr.handler(T,p-1,l).success||t.lf.handler(T,p-1,l).success?u(p,null):d()),t.lineEnd=new i((T,p,l)=>p===T.length||t.cr.handler(T,p,l).success||t.lf.handler(T,p,l).success?u(p,null):d());function h(T){const p=new i((l,s,r)=>(p.handler=T().handler,p.handler(l,s,r)));return p}t.lazy=h;function C(T){const p={};for(const l of Object.keys(T))p[l]=h(()=>{const s=T[l](p);if(s==null)throw new Error("syntax must return a parser.");return s.name=l,s});return p}t.createLanguage=C})(ut);var J={},Ae={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT=t.PLAIN=t.FN=t.LINK=t.N_URL=t.HASHTAG=t.MENTION=t.MATH_INLINE=t.INLINE_CODE=t.STRIKE=t.ITALIC=t.SMALL=t.BOLD=t.EMOJI_CODE=t.UNI_EMOJI=t.CENTER=t.MATH_BLOCK=t.CODE_BLOCK=t.SEARCH=t.QUOTE=t.isMfmBlock=void 0;const u=["quote","search","blockCode","mathBlock","center"];function d(_){return u.includes(_.type)}t.isMfmBlock=d;const i=_=>({type:"quote",children:_});t.QUOTE=i;const n=(_,j)=>({type:"search",props:{query:_,content:j}});t.SEARCH=n;const e=(_,j)=>({type:"blockCode",props:{code:_,lang:j}});t.CODE_BLOCK=e;const f=_=>({type:"mathBlock",props:{formula:_}});t.MATH_BLOCK=f;const y=_=>({type:"center",children:_});t.CENTER=y;const b=_=>({type:"unicodeEmoji",props:{emoji:_}});t.UNI_EMOJI=b;const w=_=>({type:"emojiCode",props:{name:_}});t.EMOJI_CODE=w;const h=_=>({type:"bold",children:_});t.BOLD=h;const C=_=>({type:"small",children:_});t.SMALL=C;const T=_=>({type:"italic",children:_});t.ITALIC=T;const p=_=>({type:"strike",children:_});t.STRIKE=p;const l=_=>({type:"inlineCode",props:{code:_}});t.INLINE_CODE=l;const s=_=>({type:"mathInline",props:{formula:_}});t.MATH_INLINE=s;const r=(_,j,q)=>({type:"mention",props:{username:_,host:j,acct:q}});t.MENTION=r;const o=_=>({type:"hashtag",props:{hashtag:_}});t.HASHTAG=o;const a=(_,j)=>{const q={type:"url",props:{url:_}};return j&&(q.props.brackets=j),q};t.N_URL=a;const m=(_,j,q)=>({type:"link",props:{silent:_,url:j},children:q});t.LINK=m;const v=(_,j,q)=>({type:"fn",props:{name:_,args:j},children:q});t.FN=v;const I=_=>({type:"plain",children:[(0,t.TEXT)(_)]});t.PLAIN=I;const S=_=>({type:"text",props:{text:_}});t.TEXT=S})(Ae);Object.defineProperty(J,"__esModule",{value:!0});J.inspectOne=J.stringifyTree=J.stringifyNode=J.mergeText=void 0;const Pe=Ae;function St(t){const u=[],d=[];function i(){d.length>0&&(u.push((0,Pe.TEXT)(d.join(""))),d.length=0)}const n=t.flat(1);for(const e of n)typeof e=="string"?d.push(e):!Array.isArray(e)&&e.type==="text"?d.push(e.props.text):(i(),u.push(e));return i(),u}J.mergeText=St;function nt(t){var u;switch(t.type){case"quote":return V(t.children).split(`
`).map(d=>`> ${d}`).join(`
`);case"search":return t.props.content;case"blockCode":return`\`\`\`${(u=t.props.lang)!==null&&u!==void 0?u:""}
${t.props.code}
\`\`\``;case"mathBlock":return`\\[
${t.props.formula}
\\]`;case"center":return`<center>
${V(t.children)}
</center>`;case"emojiCode":return`:${t.props.name}:`;case"unicodeEmoji":return t.props.emoji;case"bold":return`**${V(t.children)}**`;case"small":return`<small>${V(t.children)}</small>`;case"italic":return`<i>${V(t.children)}</i>`;case"strike":return`~~${V(t.children)}~~`;case"inlineCode":return`\`${t.props.code}\``;case"mathInline":return`\\(${t.props.formula}\\)`;case"mention":return t.props.acct;case"hashtag":return`#${t.props.hashtag}`;case"url":return t.props.brackets?`<${t.props.url}>`:t.props.url;case"link":return`${t.props.silent?"?":""}[${V(t.children)}](${t.props.url})`;case"fn":{const d=Object.keys(t.props.args).map(n=>{const e=t.props.args[n];return e===!0?n:`${n}=${e}`}),i=d.length>0?"."+d.join(","):"";return`$[${t.props.name}${i} ${V(t.children)}]`}case"plain":return`<plain>
${V(t.children)}
</plain>`;case"text":return t.props.text}throw new Error("unknown mfm node")}J.stringifyNode=nt;var re;(function(t){t[t.none=0]="none",t[t.inline=1]="inline",t[t.block=2]="block"})(re||(re={}));function V(t){const u=[];let d=re.none;for(const i of t){let n=!0;(0,Pe.isMfmBlock)(i)?(d===re.none&&(n=!1),d=re.block):((d===re.none||d===re.inline)&&(n=!1),d=re.inline),n&&u.push((0,Pe.TEXT)(`
`)),u.push(i)}return u.map(i=>nt(i)).join("")}J.stringifyTree=V;function st(t,u){if(u(t),t.children!=null)for(const d of t.children)st(d,u)}J.inspectOne=st;var ke={};Object.defineProperty(ke,"__esModule",{value:!0});ke.default=/(?:\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83d\udc68\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc68\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc68\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc68\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83d\udc69\ud83c[\udffb-\udfff]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffc-\udfff]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffd-\udfff]|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffd\udfff]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\ud83c\udfff\u200d\u2764\ufe0f\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83e\udef1\ud83c\udffb\u200d\ud83e\udef2\ud83c[\udffc-\udfff]|\ud83e\udef1\ud83c\udffc\u200d\ud83e\udef2\ud83c[\udffb\udffd-\udfff]|\ud83e\udef1\ud83c\udffd\u200d\ud83e\udef2\ud83c[\udffb\udffc\udffe\udfff]|\ud83e\udef1\ud83c\udffe\u200d\ud83e\udef2\ud83c[\udffb-\udffd\udfff]|\ud83e\udef1\ud83c\udfff\u200d\ud83e\udef2\ud83c[\udffb-\udffe]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d\udc8f\ud83c[\udffb-\udfff]|\ud83d\udc91\ud83c[\udffb-\udfff]|\ud83e\udd1d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d\udc8f\udc91]|\ud83e\udd1d)|(?:\ud83d[\udc68\udc69]|\ud83e\uddd1)(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf7c\udf84\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc70\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd4\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83d\ude36\u200d\ud83c\udf2b\ufe0f|\u2764\ufe0f\u200d\ud83d\udd25|\u2764\ufe0f\u200d\ud83e\ude79|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc3b\u200d\u2744\ufe0f|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83d\ude2e\u200d\ud83d\udca8|\ud83d\ude35\u200d\ud83d\udcab|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f|\ud83d\udc08\u200d\u2b1b|\ud83d\udc26\u200d\u2b1b)|[#*0-9]\ufe0f?\u20e3|(?:[©®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|\ud83e\udef0|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0c\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\udd77\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd\udec3-\udec5\udef1-\udef8]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udc8e\udc90\udc92-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5-\uded7\udedc-\udedf\udeeb\udeec\udef4-\udefc\udfe0-\udfeb\udff0]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd76\udd78-\uddb4\uddb7\uddba\uddbc-\uddcc\uddd0\uddde-\uddff\ude70-\ude7c\ude80-\ude88\ude90-\udebd\udebf-\udec2\udece-\udedb\udee0-\udee8]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g;var Ke;function Ot(){if(Ke)return ye;Ke=1;var t=se&&se.__createBinding||(Object.create?function(s,r,o,a){a===void 0&&(a=o);var m=Object.getOwnPropertyDescriptor(r,o);(!m||("get"in m?!r.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return r[o]}}),Object.defineProperty(s,a,m)}:function(s,r,o,a){a===void 0&&(a=o),s[a]=r[o]}),u=se&&se.__setModuleDefault||(Object.create?function(s,r){Object.defineProperty(s,"default",{enumerable:!0,value:r})}:function(s,r){s.default=r}),d=se&&se.__importStar||function(s){if(s&&s.__esModule)return s;var r={};if(s!=null)for(var o in s)o!=="default"&&Object.prototype.hasOwnProperty.call(s,o)&&t(r,s,o);return u(r,s),r},i=se&&se.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ye,"__esModule",{value:!0}),ye.language=void 0;const n=d(rt()),e=d(ut),f=J,y=i(ke),b=e.regexp(/[\u0020\u3000\t]/),w=e.regexp(/[a-z0-9]/i),h=e.alt([e.crlf,e.cr,e.lf]);function C(s){return new e.Parser((r,o,a)=>{const m=[];let v=o;for(let I=0;I<s.length;I++){const S=s[I].handler(r,v,a);if(!S.success)return v===o?e.failure():e.success(v,r.slice(o,v));m.push(S.value),v=S.index}return e.success(v,m)})}const T=new e.Parser((s,r,o)=>o.linkLabel?e.failure():e.success(r,null)),p=new e.Parser((s,r,o)=>o.depth<o.nestLimit?e.success(r,null):e.failure());function l(s,r){const o=e.alt([e.seq([p,s],1),r??e.char]);return new e.Parser((a,m,v)=>{v.depth++;const I=o.handler(a,m,v);return v.depth--,I})}return ye.language=e.createLanguage({fullParser:s=>s.full.many(0),simpleParser:s=>s.simple.many(0),full:s=>e.alt([s.unicodeEmoji,s.centerTag,s.smallTag,s.plainTag,s.boldTag,s.italicTag,s.strikeTag,s.urlAlt,s.big,s.boldAsta,s.italicAsta,s.boldUnder,s.italicUnder,s.codeBlock,s.inlineCode,s.quote,s.mathBlock,s.mathInline,s.strikeWave,s.fn,s.mention,s.hashtag,s.emojiCode,s.link,s.url,s.search,s.text]),simple:s=>e.alt([s.unicodeEmoji,s.emojiCode,s.text]),inline:s=>e.alt([s.unicodeEmoji,s.smallTag,s.plainTag,s.boldTag,s.italicTag,s.strikeTag,s.urlAlt,s.big,s.boldAsta,s.italicAsta,s.boldUnder,s.italicUnder,s.inlineCode,s.mathInline,s.strikeWave,s.fn,s.mention,s.hashtag,s.emojiCode,s.link,s.url,s.text]),quote:s=>{const r=e.seq([e.str(">"),b.option(),e.seq([e.notMatch(h),e.char],1).many(0).text()],2).sep(h,1),o=e.seq([h.option(),h.option(),e.lineBegin,r,h.option(),h.option()],3);return new e.Parser((a,m,v)=>{let I;if(I=o.handler(a,m,v),!I.success)return I;const S=I.value,_=I.index;return S.length===1&&S[0].length===0?e.failure():(I=l(s.fullParser).many(0).handler(S.join(`
`),0,v),I.success?e.success(_,n.QUOTE((0,f.mergeText)(I.value))):I)})},codeBlock:s=>{const r=e.str("```");return e.seq([h.option(),e.lineBegin,r,e.seq([e.notMatch(h),e.char],1).many(0),h,e.seq([e.notMatch(e.seq([h,r,e.lineEnd])),e.char],1).many(1),h,r,e.lineEnd,h.option()]).map(o=>{const a=o[3].join("").trim(),m=o[5].join("");return n.CODE_BLOCK(m,a.length>0?a:null)})},mathBlock:s=>{const r=e.str("\\["),o=e.str("\\]");return e.seq([h.option(),e.lineBegin,r,h.option(),e.seq([e.notMatch(e.seq([h.option(),o])),e.char],1).many(1),h.option(),o,e.lineEnd,h.option()]).map(a=>{const m=a[4].join("");return n.MATH_BLOCK(m)})},centerTag:s=>{const r=e.str("<center>"),o=e.str("</center>");return e.seq([h.option(),e.lineBegin,r,h.option(),e.seq([e.notMatch(e.seq([h.option(),o])),l(s.inline)],1).many(1),h.option(),o,e.lineEnd,h.option()]).map(a=>n.CENTER((0,f.mergeText)(a[4])))},big:s=>{const r=e.str("***");return C([r,e.seq([e.notMatch(r),l(s.inline)],1).many(1),r]).map(o=>typeof o=="string"?o:n.FN("tada",{},(0,f.mergeText)(o[1])))},boldAsta:s=>{const r=e.str("**");return C([r,e.seq([e.notMatch(r),l(s.inline)],1).many(1),r]).map(o=>typeof o=="string"?o:n.BOLD((0,f.mergeText)(o[1])))},boldTag:s=>{const r=e.str("<b>"),o=e.str("</b>");return C([r,e.seq([e.notMatch(o),l(s.inline)],1).many(1),o]).map(a=>typeof a=="string"?a:n.BOLD((0,f.mergeText)(a[1])))},boldUnder:s=>{const r=e.str("__");return e.seq([r,e.alt([w,b]).many(1),r]).map(o=>n.BOLD((0,f.mergeText)(o[1])))},smallTag:s=>{const r=e.str("<small>"),o=e.str("</small>");return C([r,e.seq([e.notMatch(o),l(s.inline)],1).many(1),o]).map(a=>typeof a=="string"?a:n.SMALL((0,f.mergeText)(a[1])))},italicTag:s=>{const r=e.str("<i>"),o=e.str("</i>");return C([r,e.seq([e.notMatch(o),l(s.inline)],1).many(1),o]).map(a=>typeof a=="string"?a:n.ITALIC((0,f.mergeText)(a[1])))},italicAsta:s=>{const r=e.str("*"),o=e.seq([r,e.alt([w,b]).many(1),r]);return new e.Parser((a,m,v)=>{const I=o.handler(a,m,v);if(!I.success)return e.failure();const S=a.slice(0,m);return/[a-z0-9]$/i.test(S)?e.failure():e.success(I.index,n.ITALIC((0,f.mergeText)(I.value[1])))})},italicUnder:s=>{const r=e.str("_"),o=e.seq([r,e.alt([w,b]).many(1),r]);return new e.Parser((a,m,v)=>{const I=o.handler(a,m,v);if(!I.success)return e.failure();const S=a.slice(0,m);return/[a-z0-9]$/i.test(S)?e.failure():e.success(I.index,n.ITALIC((0,f.mergeText)(I.value[1])))})},strikeTag:s=>{const r=e.str("<s>"),o=e.str("</s>");return C([r,e.seq([e.notMatch(o),l(s.inline)],1).many(1),o]).map(a=>typeof a=="string"?a:n.STRIKE((0,f.mergeText)(a[1])))},strikeWave:s=>{const r=e.str("~~");return C([r,e.seq([e.notMatch(e.alt([r,h])),l(s.inline)],1).many(1),r]).map(o=>typeof o=="string"?o:n.STRIKE((0,f.mergeText)(o[1])))},unicodeEmoji:s=>{const r=RegExp(y.default.source);return e.regexp(r).map(o=>n.UNI_EMOJI(o))},plainTag:s=>{const r=e.str("<plain>"),o=e.str("</plain>");return e.seq([r,h.option(),e.seq([e.notMatch(e.seq([h.option(),o])),e.char],1).many(1).text(),h.option(),o],2).map(a=>n.PLAIN(a))},fn:s=>{const r=new e.Parser((v,I,S)=>{const _=e.regexp(/[a-z0-9_]+/i).handler(v,I,S);return _.success?e.success(_.index,_.value):_}),o=e.seq([e.regexp(/[a-z0-9_]+/i),e.seq([e.str("="),e.regexp(/[a-z0-9_.-]+/i)],1).option()]).map(v=>({k:v[0],v:v[1]!=null?v[1]:!0})),a=e.seq([e.str("."),o.sep(e.str(","),1)],1).map(v=>{const I={};for(const S of v)I[S.k]=S.v;return I}),m=e.str("]");return C([e.str("$["),r,a.option(),e.str(" "),e.seq([e.notMatch(m),l(s.inline)],1).many(1),m]).map(v=>{if(typeof v=="string")return v;const I=v[1],S=v[2]||{},_=v[4];return n.FN(I,S,(0,f.mergeText)(_))})},inlineCode:s=>{const r=e.str("`");return e.seq([r,e.seq([e.notMatch(e.alt([r,e.str("´"),h])),e.char],1).many(1),r]).map(o=>n.INLINE_CODE(o[1].join("")))},mathInline:s=>{const r=e.str("\\("),o=e.str("\\)");return e.seq([r,e.seq([e.notMatch(e.alt([o,h])),e.char],1).many(1),o]).map(a=>n.MATH_INLINE(a[1].join("")))},mention:s=>{const r=e.seq([T,e.str("@"),e.regexp(/[a-z0-9_-]+/i),e.seq([e.str("@"),e.regexp(/[a-z0-9_.-]+/i)],1).option()]);return new e.Parser((o,a,m)=>{let v;if(v=r.handler(o,a,m),!v.success)return e.failure();const I=o.slice(0,a);if(/[a-z0-9]$/i.test(I))return e.failure();let S=!1;const _=v.index,j=v.value[2],q=v.value[3];let B=q;q!=null&&(v=/[.-]+$/.exec(q),v!=null&&(B=q.slice(0,-1*v[0].length),B.length===0&&(S=!0,B=null)));let te=j;if(v=/-+$/.exec(j),v!=null&&(B==null?te=j.slice(0,-1*v[0].length):S=!0),(te.length===0||te[0]==="-")&&(S=!0),B!=null&&/^[.-]/.test(B)&&(S=!0),S)return e.success(_,o.slice(a,_));const de=B!=null?`@${te}@${B}`:`@${te}`;return e.success(a+de.length,n.MENTION(te,B,de))})},hashtag:s=>{const r=e.str("#"),o=e.seq([e.notMatch(e.alt([e.regexp(/[ \u3000\t.,!?'"#:/[\]【】()「」（）<>]/),b,h])),e.char],1),a=e.lazy(()=>e.alt([e.seq([e.str("("),l(a,o).many(0),e.str(")")]),e.seq([e.str("["),l(a,o).many(0),e.str("]")]),e.seq([e.str("「"),l(a,o).many(0),e.str("」")]),e.seq([e.str("（"),l(a,o).many(0),e.str("）")]),o])),m=e.seq([T,r,a.many(1).text()],2);return new e.Parser((v,I,S)=>{const _=m.handler(v,I,S);if(!_.success)return e.failure();const j=v.slice(0,I);if(/[a-z0-9]$/i.test(j))return e.failure();const q=_.index,B=_.value;return/^[0-9]+$/.test(B)?e.failure():e.success(q,n.HASHTAG(B))})},emojiCode:s=>{const r=e.notMatch(e.regexp(/[a-z0-9]/i)),o=e.str(":");return e.seq([e.alt([e.lineBegin,r]),o,e.regexp(/[a-z0-9_+-]+/i),o,e.alt([e.lineEnd,r])],2).map(a=>n.EMOJI_CODE(a))},link:s=>{const r=new e.Parser((a,m,v)=>{v.linkLabel=!0;const I=s.inline.handler(a,m,v);return v.linkLabel=!1,I}),o=e.str("]");return e.seq([T,e.alt([e.str("?["),e.str("[")]),e.seq([e.notMatch(e.alt([o,h])),l(r)],1).many(1),o,e.str("("),e.alt([s.urlAlt,s.url]),e.str(")")]).map(a=>{const m=a[1]==="?[",v=a[2],I=a[5];return n.LINK(m,I.props.url,(0,f.mergeText)(v))})},url:s=>{const r=e.regexp(/[.,a-z0-9_/:%#@$&?!~=+-]/i),o=e.lazy(()=>e.alt([e.seq([e.str("("),l(o,r).many(0),e.str(")")]),e.seq([e.str("["),l(o,r).many(0),e.str("]")]),r])),a=e.seq([T,e.regexp(/https?:\/\//),o.many(1).text()]);return new e.Parser((m,v,I)=>{let S;if(S=a.handler(m,v,I),!S.success)return e.failure();const _=S.index;let j=_;const q=S.value[1];let B=S.value[2];return S=/[.,]+$/.exec(B),S!=null&&(j-=S[0].length,B=B.slice(0,-1*S[0].length),B.length===0)?e.success(_,m.slice(v,_)):e.success(j,n.N_URL(q+B,!1))})},urlAlt:s=>{const r=e.str("<"),o=e.str(">"),a=e.seq([T,r,e.regexp(/https?:\/\//),e.seq([e.notMatch(e.alt([o,b])),e.char],1).many(1),o]).text();return new e.Parser((m,v,I)=>{const S=a.handler(m,v,I);if(!S.success)return e.failure();const _=S.value.slice(1,S.value.length-1);return e.success(S.index,n.N_URL(_,!0))})},search:s=>{const r=e.alt([e.regexp(/\[(検索|search)\]/i),e.regexp(/(検索|search)/i)]);return e.seq([h.option(),e.lineBegin,e.seq([e.notMatch(e.alt([h,e.seq([b,r,e.lineEnd])])),e.char],1).many(1),b,r,e.lineEnd,h.option()]).map(o=>{const a=o[2].join("");return n.SEARCH(a,`${a}${o[3]}${o[4]}`)})},text:s=>e.char}),ye}var Je;function $t(){if(Je)return oe;Je=1,Object.defineProperty(oe,"__esModule",{value:!0}),oe.simpleParser=oe.fullParser=void 0;const t=Ot(),u=J;function d(n,e){const f=t.language.fullParser.handler(n,0,{nestLimit:e.nestLimit!=null?e.nestLimit:20,depth:0,linkLabel:!1,trace:!1});return(0,u.mergeText)(f.value)}oe.fullParser=d;function i(n){const e=t.language.simpleParser.handler(n,0,{});return(0,u.mergeText)(e.value)}return oe.simpleParser=i,oe}var Qe;function Nt(){if(Qe)return W;Qe=1,Object.defineProperty(W,"__esModule",{value:!0}),W.extract=W.inspect=W.toString=W.parseSimple=W.parse=void 0;const t=$t(),u=J;function d(y,b={}){return(0,t.fullParser)(y,{nestLimit:b.nestLimit})}W.parse=d;function i(y){return(0,t.simpleParser)(y)}W.parseSimple=i;function n(y){return Array.isArray(y)?(0,u.stringifyTree)(y):(0,u.stringifyNode)(y)}W.toString=n;function e(y,b){if(Array.isArray(y))for(const w of y)(0,u.inspectOne)(w,b);else(0,u.inspectOne)(y,b)}W.inspect=e;function f(y,b){const w=[];return e(y,h=>{b(h)&&w.push(h)}),w}return W.extract=f,W}var Xe;function rt(){return Xe||(Xe=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT=t.PLAIN=t.FN=t.LINK=t.N_URL=t.HASHTAG=t.MENTION=t.MATH_INLINE=t.INLINE_CODE=t.STRIKE=t.ITALIC=t.SMALL=t.BOLD=t.EMOJI_CODE=t.UNI_EMOJI=t.CENTER=t.MATH_BLOCK=t.CODE_BLOCK=t.SEARCH=t.QUOTE=t.extract=t.inspect=t.toString=t.parseSimple=t.parse=void 0;var u=Nt();Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return u.parse}}),Object.defineProperty(t,"parseSimple",{enumerable:!0,get:function(){return u.parseSimple}}),Object.defineProperty(t,"toString",{enumerable:!0,get:function(){return u.toString}}),Object.defineProperty(t,"inspect",{enumerable:!0,get:function(){return u.inspect}}),Object.defineProperty(t,"extract",{enumerable:!0,get:function(){return u.extract}});var d=Ae;Object.defineProperty(t,"QUOTE",{enumerable:!0,get:function(){return d.QUOTE}}),Object.defineProperty(t,"SEARCH",{enumerable:!0,get:function(){return d.SEARCH}}),Object.defineProperty(t,"CODE_BLOCK",{enumerable:!0,get:function(){return d.CODE_BLOCK}}),Object.defineProperty(t,"MATH_BLOCK",{enumerable:!0,get:function(){return d.MATH_BLOCK}}),Object.defineProperty(t,"CENTER",{enumerable:!0,get:function(){return d.CENTER}}),Object.defineProperty(t,"UNI_EMOJI",{enumerable:!0,get:function(){return d.UNI_EMOJI}}),Object.defineProperty(t,"EMOJI_CODE",{enumerable:!0,get:function(){return d.EMOJI_CODE}}),Object.defineProperty(t,"BOLD",{enumerable:!0,get:function(){return d.BOLD}}),Object.defineProperty(t,"SMALL",{enumerable:!0,get:function(){return d.SMALL}}),Object.defineProperty(t,"ITALIC",{enumerable:!0,get:function(){return d.ITALIC}}),Object.defineProperty(t,"STRIKE",{enumerable:!0,get:function(){return d.STRIKE}}),Object.defineProperty(t,"INLINE_CODE",{enumerable:!0,get:function(){return d.INLINE_CODE}}),Object.defineProperty(t,"MATH_INLINE",{enumerable:!0,get:function(){return d.MATH_INLINE}}),Object.defineProperty(t,"MENTION",{enumerable:!0,get:function(){return d.MENTION}}),Object.defineProperty(t,"HASHTAG",{enumerable:!0,get:function(){return d.HASHTAG}}),Object.defineProperty(t,"N_URL",{enumerable:!0,get:function(){return d.N_URL}}),Object.defineProperty(t,"LINK",{enumerable:!0,get:function(){return d.LINK}}),Object.defineProperty(t,"FN",{enumerable:!0,get:function(){return d.FN}}),Object.defineProperty(t,"PLAIN",{enumerable:!0,get:function(){return d.PLAIN}}),Object.defineProperty(t,"TEXT",{enumerable:!0,get:function(){return d.TEXT}})}(Ne)),Ne}var Mt=rt(),jt=function(t){var u=25,d=["useTransform","center"];if(!t)throw new Error("No config object has been provided.");for(var i of d)typeof t[i]!="boolean"&&(t[i]=!0);typeof t.gutter!="number"&&(t.gutter=u),t.container||Ye("container"),!t.items&&!t.static&&Ye("items or static")},Ye=function(t){throw new Error("Missing property '"+t+"' in MagicGrid config")},Pt=function(t){var u=t[0];for(var d of t)d.height<u.height&&(u=d);return u},X=function(u){jt(u),u.container instanceof HTMLElement?this.container=u.container:this.container=document.querySelector(u.container),this.static=u.static||!1,this.size=u.items,this.gutter=u.gutter,this.maxColumns=u.maxColumns||!1,this.useMin=u.useMin||!1,this.useTransform=u.useTransform,this.animate=u.animate||!1,this.center=u.center,this.styledItems=new Set};X.prototype.initStyles=function(){if(this.ready()){this.container.style.position="relative";for(var u=this.items(),d=0;d<u.length;d++)if(!this.styledItems.has(u[d])){var i=u[d].style;i.position="absolute",this.animate&&(i.transition=(this.useTransform?"transform":"top, left")+" 0.2s ease"),this.styledItems.add(u[d])}}};X.prototype.items=function(){return Array.from(this.container.children).filter(function(u){return getComputedStyle(u).display!=="none"})};X.prototype.colWidth=function(){return this.items()[0].getBoundingClientRect().width+this.gutter};X.prototype.setup=function(){var u=this.container.getBoundingClientRect().width,d=this.colWidth(),i=Math.floor(u/d)||1,n=[];this.maxColumns&&i>this.maxColumns&&(i=this.maxColumns);for(var e=0;e<i;e++)n[e]={height:0,index:e};var f=u-i*d+this.gutter;return{cols:n,wSpace:f}};X.prototype.nextCol=function(u,d){return this.useMin?Pt(u):u[d%u.length]};X.prototype.positionItems=function(){var u=this.setup(),d=u.cols,i=u.wSpace,n=0,e=this.colWidth(),f=this.items();i=this.center?Math.floor(i/2):0,this.initStyles();for(var y=0;y<f.length;y++){var b=this.nextCol(d,y),w=f[y],h=b.height?this.gutter:0,C=b.index*e+i+"px",T=b.height+h+"px";this.useTransform?w.style.transform="translate("+C+", "+T+")":(w.style.top=T,w.style.left=C),b.height+=w.getBoundingClientRect().height+h,b.height>n&&(n=b.height)}this.container.style.height=n+this.gutter+"px"};X.prototype.ready=function(){return this.static?!0:this.items().length>=this.size};X.prototype.getReady=function(){var u=this,d=setInterval(function(){u.ready()&&(clearInterval(d),u.listen())},100)};X.prototype.listen=function(){var u=this;if(this.ready()){var d;window.addEventListener("resize",function(){d||(d=setTimeout(function(){u.positionItems(),d=null},200))}),this.positionItems()}else this.getReady()};const ve=t=>{t.scrollTo({top:t.scrollHeight})},Me=t=>typeof t!="string"?t:t.replace(/[&'`"<>]/g,u=>({"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"})[u]),At=t=>{const u=new Date().getTime()-t.getTime(),d=new Date(u);return d.getUTCFullYear()-1970?d.getUTCFullYear()-1970+"年前":d.getUTCMonth()?d.getUTCMonth()+"ヶ月前":d.getUTCDate()-1?d.getUTCDate()-1+"日前":d.getUTCHours()?d.getUTCHours()+"時間前":d.getUTCMinutes()?d.getUTCMinutes()+"分前":d.getUTCSeconds()+"秒前"};document.addEventListener("DOMContentLoaded",async()=>{const t=document.querySelector(".grid"),u=document.querySelectorAll(".container"),d=[...u].filter($=>["media","rn-media"].some(P=>$.classList.contains(P))),i=document.getElementById("notes-list"),n=document.getElementById("renotes-list"),e=document.getElementById("media-list"),f=document.getElementById("rn-media-list"),y=document.getElementById("note-latest"),b=document.getElementById("renote-latest"),w=document.getElementById("medium-latest"),h=document.getElementById("rn-medium-latest"),C=document.querySelector(".resize-handle"),T=document.getElementById("menu-btn"),p=document.querySelector(".config"),l=document.getElementById("select-display"),s=document.getElementById("select-display-value"),r=document.getElementById("select-timeline"),a=document.querySelector(".misskey-link").querySelector("a"),m=document.querySelectorAll(".host"),v=document.forms["custom-host"],I=document.getElementById("custom-host"),S=document.getElementById("reset-host"),_=document.getElementById("keep-emojis"),j=document.getElementById("clear-emojis-cache"),q="https://misskey.io",B=m[0].textContent,te=document.title,de=new X({container:e,items:1,gutter:20,animate:!0}),le=new X({container:f,items:1,gutter:20,animate:!0});de.listen(),le.listen();let Q,U,Z=1;r.value=Z;const ae=$=>$.replace("https://",""),Ee=()=>{localStorage.getItem("tlOrigin")?(Q=localStorage.getItem("tlOrigin"),U=ae(Q),document.title=`${U} マルチタイムライン`,m.forEach($=>{$.textContent=U}),I.value=U,p.classList.add("customized-host")):(Q=q,U=ae(Q),document.title=te,m.forEach($=>{$.textContent=B}),I.value="",p.classList.remove("customized-host")),a.href=Q,_.checked=!!localStorage.getItem(`tlEmojis${U}`)};Ee();const F={},qe=async $=>{const P=ae($),x=Date.now()-Number(localStorage.getItem(`tlEmojis${P}Loaded`))>=24*60*60*1e3;if(localStorage.getItem(`tlEmojis${P}`)&&localStorage.getItem(`tlEmojis${P}Loaded`)&&!x){F[P]=JSON.parse(localStorage.getItem(`tlEmojis${P}`)),console.log("Loaded emojis from cache");return}F[P]={},await fetch(`${$}/api/emojis`).then(async D=>{const M=await D.json();D.status===200?(M.emojis.forEach(k=>{F[P][k.name]=k.url}),localStorage.setItem(`tlEmojis${P}`,JSON.stringify(F[P])),localStorage.setItem(`tlEmojis${P}Loaded`,Date.now())):console.log("error or no content",D.status)}).catch(D=>{console.error("Failed to load Emojis",D)})},G=async $=>{await qe($);const P=new Tt($),x=["homeTimeline","localTimeline","hybridTimeline","globalTimeline"],D=P.useChannel(x[Z]),M={note:!0,renote:!0,medium:!0,rnMedium:!0},N={notes:[],renotes:[],media:[],rnMedia:[]},k=150,ie=["all","hide-sensitive","sensitive-only"],Y=["全て","NSFW除外","NSFWのみ"],H=new AbortController;let K=null;const Ce=async(c,L)=>{F[L]=F[L]||{},await new Ge({origin:`https://${L}`}).request("emoji",{name:c}).then(g=>{const O=g!==null&&(L===ae($)||g.localOnly!==!0);F[L][c]=O?g.url:null}).catch(g=>{console.log(`${L}'s Emoji`,`:${c}:`,"not found"),console.dir(g),F[L][c]=null})},ue=c=>{const L=c.user.host;F[L]=F[L]||{},[c.user.emojis,c.emojis].forEach(E=>{Object.keys(E).forEach(g=>{const O=E[g];F[L][g]=O})})},me=async(c,L)=>(L=L||ae($),(!(L in F)||!(c in F[L]))&&await Ce(c,L),F[L][c]||null),ee=async(c,L)=>{if(!c)return"";const E=Mt.parseSimple(c);let g="";for(const O of E)switch(O.type){case"emojiCode":const R=await me(O.props.name,L);R===null?g+=`:${O.props.name}:`:g+=`<img class="custom-emoji" src="${R}" alt=":${O.props.name}:" title=":${O.props.name}:">`;break;case"text":g+=O.props.text.replaceAll(/\n/g,"<br>");break;case"unicodeEmoji":g+=O.props.emoji;break}return g},Ie=async(c,L)=>c.cw!==null?`[CW]${await ee(Me(c.cw),L)} <span class="cwtext">${await ee(Me(c.text),L)}</span>`:c.text?await ee(Me(c.text),L):c.renoteId||c.fileIds.length?"":'<span class="nothing">なにもありません</span>',Se=c=>c.files.some(L=>L.isSensitive),Re=async(c,L)=>{c.isRenote=!!c.renoteId,c.host=c.user.host;const E=c.isRenote?c.renote:null;E&&(E.host=E.user.host);const g={name:c.user.name?await ee(c.user.name,c.host):c.user.username,plainName:c.user.name?c.user.name:c.user.username,text:await Ie(c,c.host),fileCount:c.fileIds.length?`<span class="file-count">[${c.fileIds.length}つのファイル]</span>`:"",time:new Date(c.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit",second:"2-digit"}),containsSensitive:Se(c)||E&&Se(E)?"contains-sensitive":"",...L==="renote"&&{rnName:E.user.name?await ee(E.user.name,E.host):E.user.username,plainRnName:E.user.name?E.user.name:E.user.username,rnText:await Ie(E,E.host),rnFileCount:E.fileIds.length?`<span class="file-count">[${E.fileIds.length}つのファイル]</span>`:"",rnTime:At(new Date(E.createdAt))}};return L==="note"?`<li data-id="${c.id}" class="${g.containsSensitive}">
        <span class="wrap"><span class="name" title="${g.plainName}">${g.name}</span><span class="text">${g.text}${g.fileCount}</span></span><a href="${$}/notes/${c.id}" class="time" target="misskey" rel=”noopener”>${g.time}</a>
      </li>
      `:L==="renote"?`<li data-id="${c.id}" class="${g.containsSensitive}">
        <div class="renote-info">
          <span class="wrap"><span class="name" title="${g.plainName}">${g.name}</span><span class="text">${g.text}${g.fileCount}</span></span><a href="${$}/notes/${c.id}" class="time" target="misskey" rel=”noopener”>${g.time}</a>
        </div>
        <div class="renoted-note">
          <span class="wrap"><span class="name" title="${g.plainRnName}">${g.rnName}</span><span class="text">${g.rnText}${g.rnFileCount}</span></span><a href="${$}/notes/${E.id}" class="time" target="misskey" rel=”noopener”>${g.rnTime}</a>
        </div>
      </li>
      `:!1},Be=async(c,L)=>{c.isRenote=!!c.renoteId,c.host=c.user.host;const E=c.isRenote?c.renote:null;E&&(E.host=E.user.host);const g=L==="note"&&c||L==="renote"&&E,O=g.files[0],R={text:await Ie(g,g.host),fileCount:($e=>$e.fileIds.length>1?`<span class="more-file-count">+ ${$e.fileIds.length-1}</span>`:"")(g),containsSensitive:Se(g)||g.cw!==null?"contains-sensitive":""};return O.type.includes("image")||O.type.includes("video")?`<li data-id="${c.id}" ${E?`data-rn-id="${E.id}"`:""} class="${R.containsSensitive}">
        <a href="${$}/notes/${c.id}" class="link" target="misskey" rel=”noopener”>
          <img src="${O.thumbnailUrl||""}" alt="${O.comment||O.name}" class="${O.isSensitive||g.cw!==null?"is-sensitive":""}" ${O.type.includes("image")?`width="${O.properties.width}" height="${O.properties.height}"`:""}>
          ${O.type.includes("video")?'<span class="is-video">動画</span>':""}
          ${R.fileCount}
        </a>${R.text&&`
        <div class="text">
          ${R.text}
        </div>`}
      </li>
      `:O.type.includes("audio")?`<li data-id="${c.id}" ${E?`data-rn-id="${E.id}"`:""} class="${R.containsSensitive}">
        <a href="${$}/notes/${c.id}" class="link" target="misskey" rel=”noopener”>
          <span class="file-type">音声</span>
          ${R.fileCount}
        </a>${R.text&&`
        <div class="text">
          ${R.text}
        </div>`}
      </li>
      `:`<li data-id="${c.id}" ${E?`data-rn-id="${E.id}"`:""} class="${R.containsSensitive}">
        <a href="${$}/notes/${c.id}" class="link" target="misskey" rel=”noopener”>
          <span class="file-type">その他:${O.type}</span>
          ${R.fileCount}
        </a>${R.text&&`
        <div class="text">
          ${R.text}
        </div>`}
      </li>
      `},De=()=>{document.querySelectorAll("li .wrap").forEach(E=>{const g=E.querySelector(".text");E.classList.contains("is-open")||E.offsetWidth<E.scrollWidth||g.querySelector("br")?g.classList.add("is-long"):g.classList.remove("is-long")}),document.querySelectorAll("li > div.text").forEach(E=>{E.classList.contains("is-open")||E.offsetWidth<E.scrollWidth||E.querySelector("br")?E.classList.add("is-long"):E.classList.remove("is-long")})};window.addEventListener("resize",De,{signal:H.signal});let pe=!1;document.addEventListener("selectstart",()=>{document.addEventListener("pointerup",()=>{pe=!window.getSelection().isCollapsed},{once:!0,signal:H.signal})},{signal:H.signal});const ne={note:!1,renote:!1,medium:!1,rnMedium:!1},He=c=>{if(pe){pe=!1;return}(c.target.closest(".is-long")||c.target.closest(".wrap")&&c.target.querySelector(".is-long"))&&(c.target.closest(".wrap").classList.toggle("is-open"),c.target.closest(".wrap").classList.contains("is-open")?c.currentTarget===i?(ne.note=M.note,M.note=!1,y.classList.add("show")):c.currentTarget===n&&(ne.renote=M.renote,M.renote=!1,b.classList.add("show")):c.currentTarget===i?ne.note&&y.click():c.currentTarget===n&&ne.renote&&b.click())};i.addEventListener("click",He,{signal:H.signal}),n.addEventListener("click",He,{signal:H.signal});const Ue=c=>{if(pe){pe=!1;return}c.target.closest(".is-long")&&(c.target.closest(".is-long").classList.toggle("is-open"),c.currentTarget===e?de.positionItems():c.currentTarget===f&&le.positionItems(),c.target.closest(".is-long").classList.contains("is-open")?c.currentTarget===e?(ne.medium=M.medium,M.medium=!1,w.classList.add("show")):c.currentTarget===f&&(ne.rnMedium=M.rnMedium,M.rnMedium=!1,h.classList.add("show")):c.currentTarget===e?ne.medium&&w.click():c.currentTarget===f&&ne.rnMedium&&h.click())};e.addEventListener("click",Ue,{signal:H.signal}),f.addEventListener("click",Ue,{signal:H.signal}),Node.prototype.appendToTl=async function(c){if(this!==i&&this!==n&&this!==e&&this!==f)return!1;const L=!Array.isArray(c);let E="";if(this===i||this===n){const g=this===i&&"note"||this===n&&"renote";if(L)E=await Re(c,g);else{const O=c;for(;O.length;)E+=await Re(O.shift(),g)}for(this.insertAdjacentHTML("beforeend",E),M[this===i&&"note"||this===n&&"renote"]&&ve(this.parentElement);this.querySelectorAll("li").length>k;)this.firstElementChild.remove()}else if(this===e||this===f){const g=this===e&&"note"||this===f&&"renote",O=!L&&c.length||1;if(L){const z=c;if(g=="renote"){const be=f.querySelector(`[data-rn-id="${z.renoteId}"]`);be&&be.remove()}E=await Be(z,g)}else{const z=c;for(;z.length;){const be=z.pop();if(g=="renote"){const We=f.querySelector(`[data-rn-id="${be.renoteId}"]`);We&&We.remove()}E+=await Be(be,g)}}for(this.insertAdjacentHTML("afterbegin",E),M[this===e&&"medium"||this===f&&"rnMedium"]&&this.parentElement.scrollTo({top:0});this.querySelectorAll("li").length>k;)this.lastElementChild.remove();const R=[...this.children].slice(0,O);R.some(z=>getComputedStyle(z).display!=="none")&&(this===e?de.positionItems():this===f&&le.positionItems()),R.map(z=>z.querySelector("img")).filter(z=>z&&z.style.width===""&&z.src!=="").forEach(z=>{z.addEventListener("load",()=>{this===e?de.positionItems():this===f&&le.positionItems()},{once:!0})})}De()},P.on("_connected_",async()=>{console.log("connected"),document.visibilityState==="visible"&&(K=await navigator.wakeLock.request("screen"))}),P.on("_disconnected_",()=>{console.log("disconnected"),K!==null&&K.release().then(()=>{K=null})}),document.addEventListener("visibilitychange",async()=>{K!==null&&document.visibilityState==="visible"&&P.state=="connected"&&(K=await navigator.wakeLock.request("screen"))},{signal:H.signal});const xe=async c=>{const L=!!c.renoteId,E=!!(c.text!==null||c.fileIds.length||!L);if(c.user.host&&ue(c),E&&(M.note?await i.appendToTl(c):(N.notes.push(c),N.notes.length>k&&(N.notes=N.notes.slice(-k)))),L){const O=c.renote;O.user.host&&ue(O),M.renote?await n.appendToTl(c):(N.renotes.push(c),N.renotes.length>k&&(N.renotes=N.renotes.slice(-k)))}if(c.fileIds.length&&(M.medium?await e.appendToTl(c):(N.media.push(c),N.media.length>k&&(N.media=N.media.slice(-k)))),L&&c.renote.fileIds.length)if(M.rnMedium)await f.appendToTl(c);else{const O=N.rnMedia.findIndex(R=>R.renoteId===c.renoteId);O!==-1&&N.rnMedia.splice(O,1),N.rnMedia.push(c),N.rnMedia.length>k&&(N.rnMedia=N.rnMedia.slice(-k))}},ze=["timeline","local-timeline","hybrid-timeline","global-timeline"];await new Ge({origin:$}).request(`notes/${ze[Z]}`,{limit:15}).then(async c=>{c=c.reverse();let L=Promise.resolve();c.forEach(E=>L=L.then(()=>xe(E))),await L}).catch(c=>{console.log(`${U}'s`,`notes/${ze[Z]}`,"could not load"),console.dir(c)}),D.on("note",xe);const _e=async c=>{const L=c.target;L.textContent="読み込み中...",L===y?(M.note=!0,await i.appendToTl(N.notes)):L===b?(M.renote=!0,await n.appendToTl(N.renotes)):L===w?(M.medium=!0,await e.appendToTl(N.media)):L===h&&(M.rnMedium=!0,await f.appendToTl(N.rnMedia)),L.classList.remove("show"),L.textContent="新しいノートを見る"};y.addEventListener("click",_e,{signal:H.signal}),b.addEventListener("click",_e,{signal:H.signal}),w.addEventListener("click",_e,{signal:H.signal}),h.addEventListener("click",_e,{signal:H.signal}),u.forEach(c=>{c.addEventListener("scroll",async L=>{const E=c.querySelector('button[id$="-latest"]'),g=c.classList.contains("notes")?"notes":c.classList.contains("renotes")?"renotes":c.classList.contains("media")?"media":c.classList.contains("rn-media")?"rn-media":null;g==="notes"||g==="renotes"?c.scrollHeight-c.clientHeight-c.scrollTop>=3?(M[g.slice(0,-1)]=!1,E.classList.add("show")):N[g].length?g==="notes"?await i.appendToTl(N.notes):g==="renotes"&&await n.appendToTl(N.renotes):(M[g.slice(0,-1)]=!0,E.classList.remove("show")):(g==="media"||g==="rn-media")&&(c.scrollTop>1?(M[g==="media"&&"medium"||g==="rn-media"&&"rnMedium"]=!1,E.classList.add("show")):(N[g==="media"&&"media"||g==="rn-media"&&"rnMedia"].length&&(g==="media"?await e.appendToTl(N.media):g==="rn-media"&&await f.appendToTl(N.rnMedia)),M[g==="media"&&"medium"||g==="rn-media"&&"rnMedium"]=!0,E.classList.remove("show")))},{signal:H.signal})});const Fe=()=>{const c=document.querySelector(".confirm-sensitive"),L=document.getElementsByName("confirm-sensitive");let E;return c.classList.add("show"),L[0].focus(),[...L].forEach(g=>{g.addEventListener("click",O=>{O.target.value==="yes"?E(!0):O.target.value==="no"&&E(!1),c.classList.remove("show")},{signal:H.signal})}),new Promise(g=>{E=g})};let Oe=!1;if(localStorage.getItem("tlDisplay")){const c=localStorage.getItem("tlDisplay");if(c==="2"){const L=await Fe();l.value=L?c:c-1,L&&(Oe=!0)}else l.value=c;s.textContent=Y[l.value]}let ge=l.value;t.classList.add(ie[ge]),l.addEventListener("pointerdown",()=>{s.textContent=Y[ge]},{once:!0,signal:H.signal}),l.addEventListener("input",async()=>{if(l.value==="2"&&!Oe)if(await Fe())Oe=!0;else{l.value=ge;return}l.value!=="0"?localStorage.setItem("tlDisplay",l.value):localStorage.removeItem("tlDisplay"),t.classList.add(ie[l.value]),s.textContent=Y[l.value],t.classList.remove(ie[ge]),ge=l.value,M.note&&ve(i.parentElement),M.renote&&ve(n.parentElement),[...e.children].some(c=>getComputedStyle(c).display!=="none")&&de.positionItems(),[...f.children].some(c=>getComputedStyle(c).display!=="none")&&le.positionItems()},{signal:H.signal}),document.addEventListener("keydown",c=>{c.key==="Escape"&&(D.dispose(),K!==null&&K.release().then(()=>{K=null}),alert("Escキーが押されたため、タイムラインの受信を停止しました。"))},{signal:H.signal}),G.notesScrollToBottom=()=>{M.note&&ve(i.parentElement),M.renote&&ve(n.parentElement)},G.dispose=()=>{D.dispose(),H.abort(),[i,n,e,f].forEach(c=>{c.textContent=""}),[e,f].forEach(c=>{c.removeAttribute("style")})}};await G(Q);const Te=t.clientHeight,he=56;if(localStorage.getItem("tlGridHorizontalRatio")){const $=localStorage.getItem("tlGridHorizontalRatio"),x=(Te-he)/Te,D=$*x;t.style.gridTemplateRows=`${he}px ${D}% ${x*100-D}%`,d.forEach(M=>{M.style.paddingBottom=`${(x*100-D)*(Te/window.innerHeight)}dvh`})}const Le=()=>{C.classList.remove("hover")};C.addEventListener("pointerenter",()=>{C.classList.add("hover")}),C.addEventListener("pointerleave",Le),C.addEventListener("pointerdown",$=>{C.removeEventListener("pointerleave",Le);const P=D=>{const M=t.clientHeight,N=Math.round(D.pageY),k=M-he,ie=k/M,Y=N-he;if(!D.isPrimary||Y<0||Y>k)return;const H=k/2,K=Y-H,Ce=K<=15&&K>=-15;let ue;if(Ce){t.removeAttribute("style"),localStorage.removeItem("tlGridHorizontalRatio"),d.forEach(ee=>{ee.removeAttribute("style")}),G.notesScrollToBottom();return}else Y<=15?ue=0:k-Y<=15?ue=100:ue=Y/k*100;const me=ue*ie;t.style.gridTemplateRows=`${he}px ${me}% ${ie*100-me}%`,localStorage.setItem("tlGridHorizontalRatio",ue),d.forEach(ee=>{ee.style.paddingBottom=`${(ie*100-me)*(M/window.innerHeight)}dvh`}),G.notesScrollToBottom()};document.addEventListener("pointermove",P);const x=D=>{D.isPrimary&&(C.classList.remove("hover"),document.removeEventListener("pointermove",P),document.removeEventListener("pointerup",x),C.addEventListener("pointerleave",Le))};document.addEventListener("pointerup",x)}),C.addEventListener("dblclick",()=>{t.removeAttribute("style"),localStorage.removeItem("tlGridHorizontalRatio"),d.forEach($=>{$.removeAttribute("style")}),G.notesScrollToBottom()});const fe=document.body,we=$=>{!$.target.closest(".config")&&!$.target.closest(".confirm-sensitive")&&(fe.classList.remove("show-config"),fe.removeEventListener("pointerdown",we))};T.addEventListener("pointerdown",$=>{$.stopPropagation()}),T.addEventListener("click",$=>{$.stopPropagation(),fe.classList.toggle("show-config"),fe.classList.contains("show-config")?fe.addEventListener("pointerdown",we):fe.removeEventListener("pointerdown",we)}),r.addEventListener("change",async()=>{G.dispose(),Z=Number(r.value),await G(Q)}),v.addEventListener("submit",async $=>{$.preventDefault(),G.dispose(),I.value!==ae(q)?(localStorage.setItem("tlOrigin",`https://${I.value}`),Q!==q&&(_.checked||(localStorage.removeItem(`tlEmojis${U}`),localStorage.removeItem(`tlEmojis${U}Loaded`)))):localStorage.removeItem("tlOrigin"),Ee(),Z=1,r.value=Z,_.checked=!!localStorage.getItem(`tlEmojis${U}`),await G(Q)}),S.addEventListener("click",async()=>{G.dispose(),localStorage.removeItem("tlOrigin"),_.checked||(localStorage.removeItem(`tlEmojis${U}`),localStorage.removeItem(`tlEmojis${U}Loaded`)),Ee(),Z=1,r.value=Z,_.checked=!!localStorage.getItem(`tlEmojis${U}`),await G(Q)}),j.addEventListener("click",async()=>{const $=localStorage.getItem(`tlEmojis${U}`);localStorage.removeItem(`tlEmojis${U}`),await qe(Q);const P=localStorage.getItem(`tlEmojis${U}`);if($===P)alert("絵文字URLを再取得しましたが、変更はありませんでした。");else{const x={oldEmojis:JSON.parse($),newEmojis:JSON.parse(P)},D=Object.keys(x.oldEmojis),M=Object.keys(x.newEmojis),N={old:D.filter(k=>!(k in x.newEmojis)),new:M.filter(k=>!(k in x.oldEmojis))};alert(`絵文字URLを再取得した結果、変更がありました。
消去された絵文字(${N.old.length}件):
${N.old.length?`:${N.old.join(`:
:`)}:`:"なし"}
登録された絵文字(${N.new.length}件):
${N.new.length?`:${N.new.join(`:
:`)}:`:"なし"}`)}})});
